<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advertisement</title>
    
    <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
    <link href="https://unpkg.com/videojs-contrib-ads/dist/videojs.ads.css" rel="stylesheet" />
    <link href="https://unpkg.com/videojs-ima/dist/videojs.ima.css" rel="stylesheet" />

    <style>
        html, body { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background-color: #000; }
        #ad-container { width: 100%; height: 100%; }
        .video-js { width: 100%; height: 100%; }
        
        /* Play button ke liye overlay */
        #play-overlay {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            z-index: 20; /* Sabse upar */
        }
        #play-button {
            width: 80px;
            height: 80px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px solid white;
        }
        #play-button svg {
            width: 40px;
            height: 40px;
            fill: white;
            margin-left: 5px;
        }
    </style>
</head>
<body>

    <div id="ad-container">
        <video id="ad-player" class="video-js" playsinline></video>
    </div>

    <!-- Ad chalane ke liye Play Button -->
    <div id="play-overlay">
        <div id="play-button">
            <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"></path></svg>
        </div>
    </div>

    <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
    <script src="https://imasdk.googleapis.com/js/sdkloader/ima3.js"></script>
    <script src="https://unpkg.com/videojs-contrib-ads/dist/videojs.ads.min.js"></script>
    <script src="https://unpkg.com/videojs-ima/dist/videojs.ima.min.js"></script>

    <script>
        (function() {
            const playOverlay = document.getElementById('play-overlay');
            const urlParams = new URLSearchParams(window.location.search);
            const movieUrl = urlParams.get('redirect');

            const redirectToMovie = () => {
                if (movieUrl) window.location.href = movieUrl;
            };

            if (!movieUrl) {
                document.body.innerHTML = "<h1>Error: Movie link not found.</h1>";
                return;
            }

            // Player ko initialize karo, lekin autoplay mat karo
            const player = videojs('ad-player', { controls: false });

            // Ad plugin ko set karo
            const imaOptions = {
                // Yahan Google ka test link hai. Iske chalne ke baad apna link daalna.
                adTagUrl: 'https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/single_ad_samples&ciu_szs=300x250&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ct%3Dlinear&correlator='
            };
            player.ima(imaOptions);

            // Ad khatam hone par redirect karo
            player.on('adsended', redirectToMovie);
            // Ad fail hone par bhi redirect karo
            player.on(['adserror', 'adtimeout', 'nopreroll'], redirectToMovie);

            // Jab user Play button par click karega
            playOverlay.addEventListener('click', () => {
                // Overlay ko hata do
                playOverlay.style.display = 'none';
                // Ab player ko play karo (user ne permission de di hai)
                player.play();
            });
        })();
    </script>

</body>
</html>
